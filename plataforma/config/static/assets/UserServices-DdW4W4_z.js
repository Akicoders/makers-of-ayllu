import{X as b,G as j,r as v,j as s,e as g,h as N,C as k,k as C}from"./react-sWiKbk-Z.js";import{B as S}from"./BaseDrawer-BkvK-6Gl.js";import"./inertia-Dgc5Zg7U.js";import"./axios-ngrFHoWO.js";import"./vendor-Z5AVMo_k.js";const B=({show:r,onHide:n})=>{const{props:l}=b(),{data:i,setData:m,post:p,processing:u,errors:d,reset:x,clearErrors:o,transform:f}=j({id:null,first_name:"",last_name:"",email:"",current_role:null,current_rank:null,services:[]});v.useEffect(()=>{if(!r){const e=setTimeout(()=>{x(),o()},300);return()=>clearTimeout(e)}},[r]),v.useEffect(()=>{const e=l.user;e&&r&&(m({id:e.id,first_name:e.first_name,last_name:e.last_name,email:e.email,current_role:e.current_role,current_rank:e.current_rank,services:e.services.map(t=>({...t,custom_cost:t.custom_cost??t.base_cost,final_cost:t.custom_cost&&t.custom_cost>0?t.custom_cost:t.base_cost}))}),o())},[l.user,r]);const h=(e,t)=>{const c=[...i.services],a=c[e];a.custom_cost=t||0,a.final_cost=a.custom_cost&&a.custom_cost>0?a.custom_cost:a.base_cost,m("services",c)},_=()=>{i.id,i.services.map(e=>({service_id:e.service_id,custom_cost:e.custom_cost||0,is_active:!!e.is_active})),f(e=>({user_id:e.id,services:e.services.map(t=>({service_id:t.service_id,custom_cost:t.custom_cost||0,is_active:!!t.is_active}))})),p("/administrador/usuarios/services/update/",{onSuccess:()=>{n(),o()}})};return s.jsx(S,{show:r,onHide:n,title:"Personalizar Servicios de Usuario",subtitle:"Actualiza los creditos de los servicios",icon:"pi pi-user-edit",confirmLabel:"Guardar Cambios",loading:u,onConfirm:_,children:s.jsxs("main",{className:"py-4 sm:py-6 relative",children:[u&&s.jsx("div",{className:"absolute inset-0 bg-slate-100/50 dark:bg-slate-900/50 z-10 flex items-center justify-center backdrop-blur-sm",children:s.jsx(g,{strokeWidth:"4",animationDuration:".5s",style:{width:"50px",height:"50px"}})}),s.jsx("div",{className:"mb-4",children:s.jsxs("h3",{className:"text-lg font-semibold dark:text-gray-100",children:["Usuario: ",i.first_name," ",i.last_name]})}),s.jsx(N,{in:r,timeout:500,classNames:"fade-slide",appear:!0,unmountOnExit:!0,children:s.jsx("form",{onSubmit:e=>{e.preventDefault(),_()},className:"space-y-6",children:i.services.map((e,t)=>s.jsx(k,{className:"shadow-xl rounded-2xl border border-slate-200 dark:border-slate-700 hover:shadow-lg transition-shadow duration-300",children:s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx("div",{className:"font-bold dark:text-gray-200",children:e.name})}),s.jsx("div",{className:"w-56 flex flex-col items-end gap-2",children:s.jsx("div",{className:"flex items-center gap-2",children:s.jsx(C,{value:e.custom_cost,onValueChange:c=>h(t,c.value),showButtons:!0,min:0,useGrouping:!1,inputClassName:"w-20"})})})]})},e.service_id))})}),d.services&&s.jsx("div",{className:"mt-3 text-red-600",children:d.services})]})})};export{B as default};
