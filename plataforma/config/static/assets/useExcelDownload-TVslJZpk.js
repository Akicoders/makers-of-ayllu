import{r as s}from"./react-sWiKbk-Z.js";import{a as w}from"./axios-ngrFHoWO.js";function D(){const[f,r]=s.useState(!1),[n,c]=s.useState(null),[l,i]=s.useState(null);return{downloading:f,downloadUrl:n,downloadFilename:l,exportExcel:async(e,m={})=>{r(!0),c(null),i(null);const d=new FormData;Object.entries(m).forEach(([o,t])=>{t!=null&&d.append(o,String(t))});try{const o=await w.post(e,d,{responseType:"blob"});let t="reporte.xlsx";const a=o.headers["content-disposition"];if(a&&a.includes("filename=")){const p=a.split("filename=");p.length>1&&(t=p[1].replace(/['"]/g,""))}const u=new Blob([o.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});i(t);const x=URL.createObjectURL(u);c(x)}catch(o){console.error(o),alert("Error al exportar el Excel")}finally{r(!1)}},downloadExcel:()=>{if(!n||!l)return;const e=document.createElement("a");e.href=n,e.download=l,document.body.appendChild(e),e.click(),e.remove()}}}export{D as u};
