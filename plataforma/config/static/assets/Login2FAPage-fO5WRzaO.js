import{G as v,r as a,j as e,e as L,M as P,I as V,h as m,B as N,x as O}from"./react-sWiKbk-Z.js";import{A as B}from"./AuthLayout-BW1xDVse.js";import"./inertia-Dgc5Zg7U.js";import"./axios-ngrFHoWO.js";import"./vendor-Z5AVMo_k.js";import"./FloatingConfigurator-DSB3k6EL.js";import"./app-DEFaNKxM.js";const X=({email:n,errors:D,success:u})=>{const{data:d,setData:k,post:w,processing:c,errors:i,clearErrors:E}=v({code:""}),l=v({}),[o,g]=a.useState(0),[s,f]=a.useState(300),x=o===0,R=a.useMemo(()=>{const t=Math.floor(s/60),r=s%60;return`${t}:${r.toString().padStart(2,"0")}`},[s]),C=a.useMemo(()=>s<=30?"text-red-500 dark:text-red-400":s<=60?"text-orange-500 dark:text-orange-400":"text-brand-primary dark:text-brand-primary",[s]),$=s/300*100;a.useEffect(()=>{let t;return o>0&&(t=setInterval(()=>{g(r=>r-1)},1e3)),()=>{t&&clearInterval(t)}},[o]),a.useEffect(()=>{let t;return s>0&&(t=setInterval(()=>{f(r=>r<=1?(clearInterval(t),window.location.href="/",0):r-1)},1e3)),()=>{t&&clearInterval(t)}},[s]),a.useEffect(()=>{p()},[]);const p=()=>{g(30)},S=t=>{t.preventDefault(),!(d.code.trim().length!==6||s<=0)&&w("/verify-2fa/",{onSuccess:()=>{E()}})},I=()=>{x&&l.post("/resend-2fa/",{onSuccess:()=>{p(),f(300)}})},M=a.useMemo(()=>{if(!n)return"";const t=n.split("@");if(t.length!==2)return n;const[r,y]=t;if(r.length<=2)return`${r[0]}*@${y}`;const F=r.substring(0,2),T=r.substring(r.length-1),z="*".repeat(Math.max(0,r.length-3));return`${F}${z}${T}@${y}`},[n]),h=a.useRef(null),b=a.useRef(null),j=a.useRef(null),_=t=>t?Array.isArray(t)?t[0]:t:"",A=e.jsxs("h1",{className:"text-5xl font-extrabold mb-6 leading-tight text-white",children:["Seguridad ",e.jsx("span",{className:"text-brand-primary",children:"Garantizada"})]});return e.jsxs(B,{title:A,subtitle:"Tu seguridad es nuestra prioridad. La autenticación de dos factores protege tu cuenta contra accesos no autorizados.",children:[(c||l.processing)&&e.jsx("div",{className:"absolute inset-0 bg-white/60 dark:bg-black/60 z-50 flex items-center justify-center backdrop-blur-sm rounded-3xl",children:e.jsx(L,{style:{width:"50px",height:"50px"},strokeWidth:"4"})}),e.jsxs("div",{className:"text-center lg:text-left",children:[e.jsx("div",{className:"lg:hidden flex justify-center mb-6",children:e.jsx("i",{className:"pi pi-shield text-5xl text-brand-primary"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Verificación 2FA"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Introduce el código enviado a tu correo"})]}),e.jsxs("div",{className:"space-y-6 mt-8",children:[e.jsxs("div",{className:"bg-brand-light dark:bg-surface-0/5 rounded-xl p-4 border border-brand-primary/20 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-brand-primary/10 flex items-center justify-center shrink-0",children:e.jsx("i",{className:"pi pi-envelope text-brand-primary text-xl"})}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("p",{className:"text-xs text-gray-500 flex items-center gap-2",children:"Código enviado a:"}),e.jsx("p",{className:"font-mono font-bold text-gray-900 dark:text-white truncate",title:n,children:M})]})]}),u&&e.jsx(P,{severity:"success",className:"w-full justify-start",text:u}),e.jsxs("div",{className:"relative overflow-hidden rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-surface-card p-4",children:[e.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-brand-primary transition-all duration-1000 ease-linear",style:{width:`${$}%`}}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("i",{className:"pi pi-clock text-gray-400 text-xl"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Expira en"}),e.jsx("p",{className:`text-xl font-bold font-mono ${C}`,children:R})]})]})})]}),e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"code",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5 ml-1",children:"Código de Verificación"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 z-10",children:e.jsx("i",{className:"pi pi-lock text-slate-400"})}),e.jsx(V,{id:"code",value:d.code,onChange:t=>k("code",t.target.value),className:`w-full pl-12 py-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900/50 text-slate-900 dark:text-white placeholder:text-slate-400 focus:border-cyan-500 focus:ring-4 focus:ring-cyan-500/10 transition-all duration-200 outline-none shadow-sm text-center tracking-[1em] font-mono text-lg ${i.code?"!border-red-500 focus:!ring-red-500/10":""}`,placeholder:"000000",maxLength:6})]}),e.jsx(m,{in:!!i.code,timeout:300,classNames:"slide-fade",unmountOnExit:!0,nodeRef:j,children:e.jsx("div",{ref:j,children:e.jsxs("div",{className:"mt-1.5 text-xs font-medium text-red-500 flex items-center gap-1",children:[e.jsx("i",{className:"pi pi-exclamation-circle"}),e.jsx("span",{children:_(i.code)})]})})})]}),e.jsx(m,{nodeRef:h,in:!!i.__all__,timeout:300,classNames:"slide-down",unmountOnExit:!0,children:e.jsxs("div",{ref:h,className:"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 p-3 rounded-lg text-sm flex items-center gap-2",children:[e.jsx("i",{className:"pi pi-exclamation-triangle"}),e.jsx("span",{children:i.__all__})]})}),e.jsx(m,{nodeRef:b,in:s<=0,timeout:300,classNames:"slide-down",unmountOnExit:!0,children:e.jsxs("div",{ref:b,className:"bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 p-3 rounded-lg text-sm flex items-center gap-2",children:[e.jsx("i",{className:"pi pi-clock"}),e.jsx("span",{children:"El código ha expirado. Por favor solicita uno nuevo."})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{type:"submit",disabled:d.code.length!==6||c||s<=0,loading:c,label:"Verificar Código",className:"w-full py-3.5 font-bold text-white bg-brand-primary hover:bg-brand-primary-dark rounded-lg shadow-lg hover:shadow-brand-primary/20 transition-all duration-200"}),e.jsx(N,{type:"button",onClick:I,disabled:!x||l.processing,loading:l.processing,className:"w-full py-3.5 font-medium text-gray-700 dark:text-gray-300 bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg transition-all duration-200",children:x?"Reenviar Código":`Reenviar en ${o}s`})]})]}),e.jsxs("div",{className:"relative pt-2",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-200 dark:border-gray-700"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-brand-light dark:bg-surface-ground text-gray-500",children:"o"})})]}),e.jsxs(O,{href:"/",className:"flex items-center justify-center gap-2 text-sm font-medium text-gray-500 hover:text-brand-primary transition-colors",children:[e.jsx("i",{className:"pi pi-arrow-left"}),"Volver al inicio de sesión"]})]})]})};export{X as default};
