import{r as i,G as A,A as p,j as t,I as D,B as j,D as Y,h as z,e as B,m as I,n as $,w as q}from"./react-sWiKbk-Z.js";import{e as M}from"./vendor-Z5AVMo_k.js";const W=({headers:N,data:e,placeholderSearch:w="Buscar...",defaultFilters:m={},routeSearch:n,sortableColumns:_=[],renderFilters:x,renderBody:d={}})=>{var k,y,v;const[u,S]=i.useState(!1),C=[5,10,20,50].map(s=>({label:`${s}`,value:s})),{data:r,setData:a,get:P,processing:g}=A({search:((k=e==null?void 0:e.filters)==null?void 0:k.search)??"",page:(e==null?void 0:e.current_page)??1,per_page:(e==null?void 0:e.per_page)??10,sort_by:((y=e==null?void 0:e.filters)==null?void 0:y.sort_by)??null,sort_direction:((v=e==null?void 0:e.filters)==null?void 0:v.sort_direction)??"asc",...m,...e==null?void 0:e.filters});i.useEffect(()=>{a(s=>({...s,...e==null?void 0:e.filters,page:e==null?void 0:e.current_page,per_page:e==null?void 0:e.per_page}))},[e]);const E=(s=!1)=>{const l=Object.entries(r).reduce((o,[T,c])=>(c!==null&&c!==""&&!(Array.isArray(c)&&c.length===0)&&(o[T]=c),o),{});P(n,{preserveState:!0,preserveScroll:!0,replace:!0,data:l})};i.useRef(M(s=>{},400)).current,i.useEffect(()=>{const s=setTimeout(()=>{var l;r.search!==(((l=e==null?void 0:e.filters)==null?void 0:l.search)??"")&&a("page",1)},400);return()=>clearTimeout(s)},[r.search]);const f=i.useRef(!0);i.useEffect(()=>{if(f.current){f.current=!1;return}const s=setTimeout(()=>{var l;if(r.search!==(((l=e==null?void 0:e.filters)==null?void 0:l.search)??"")){const o={...r,page:1};p.get(n,o,{preserveState:!0,preserveScroll:!0,replace:!0})}},400);return()=>clearTimeout(s)},[r.search]),i.useEffect(()=>{if(r.per_page!==(e==null?void 0:e.per_page)){const s={...r,page:1};p.get(n,s,{preserveState:!0,preserveScroll:!0,replace:!0})}},[r.per_page]);const O=s=>{const l=s.page+1;a("page",l);const o={...r,page:l};p.get(n,o,{preserveState:!0,preserveScroll:!0,replace:!0})},R=s=>{const l={...r,sort_by:s.sortField,sort_direction:s.sortOrder===1?"asc":"desc"};a(o=>({...o,sort_by:s.sortField,sort_direction:s.sortOrder===1?"asc":"desc"})),p.get(n,l,{preserveState:!0,preserveScroll:!0,replace:!0})},F=()=>{const s={search:"",page:1,per_page:10,sort_by:null,sort_direction:"asc",...Object.fromEntries(Object.keys(m).map(l=>[l,null]))};p.get(n,s,{preserveState:!0,replace:!0})},b=(e==null?void 0:e.data)??[],L=(e.current_page-1)*e.per_page,h=i.useRef(null);return t.jsxs("div",{className:"card dark:backdrop-blur-sm rounded-2xl shadow-lg shadow-slate-200/50 dark:shadow-black/20 p-4 sm:p-6 space-y-6",children:[t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[t.jsxs("div",{className:"relative w-full sm:w-auto sm:flex-grow max-w-md",children:[t.jsx("i",{className:"pi pi-search absolute inset-y-0 left-0 flex items-center pl-3 text-slate-400 dark:text-slate-500"}),t.jsx(D,{value:r.search,onChange:s=>a("search",s.target.value),placeholder:w,className:"w-full !pl-10 !py-2.5 !rounded-full border-transparent focus:border-sky-500 focus:ring-2 focus:ring-sky-500/50 transition-all duration-300"}),r.search&&t.jsx("button",{onClick:()=>a("search",""),className:"absolute inset-y-0 right-0 flex items-center pr-3 p-1 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 transition",children:t.jsx("i",{className:"pi pi-times text-slate-500 text-sm"})})]}),t.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto justify-end",children:[t.jsx(j,{tooltip:"Filtros avanzados",tooltipOptions:{position:"bottom"},onClick:()=>S(!u),icon:"pi pi-sliders-h",rounded:!0,text:!0,severity:"secondary",className:`transition-colors !bg-slate-100 hover:!bg-slate-200 dark:!bg-slate-800 dark:hover:!bg-slate-700 ${u?"!bg-sky-100 dark:!bg-sky-900/50 text-sky-500":""}`}),t.jsx(j,{tooltip:"Limpiar filtros",tooltipOptions:{position:"bottom"},icon:"pi pi-filter-slash",text:!0,rounded:!0,severity:"secondary",onClick:F,className:"transition-all duration-300 hover:rotate-12 hover:scale-110 !bg-slate-100 hover:!bg-slate-200 dark:!bg-slate-800 dark:hover:!bg-slate-700"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("label",{className:"text-sm font-medium text-slate-600 dark:text-slate-400 hidden sm:block",children:"Mostrar:"}),t.jsx(Y,{value:r.per_page,options:C,optionLabel:"label",optionValue:"value",onChange:s=>a("per_page",s.value),className:"w-24 text-sm",pt:{root:{className:"rounded-xl border-slate-200 dark:border-slate-700"},input:{className:"!py-2 !text-sm"},trigger:{className:"!w-10"}}})]})]})]}),t.jsx(z,{nodeRef:h,in:u,timeout:300,classNames:"slide-fade",unmountOnExit:!0,children:t.jsx("div",{ref:h,className:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-xl border border-slate-200 dark:border-slate-700",children:x&&x({filters:r,setData:a,submit:E})})}),t.jsxs("div",{className:"relative overflow-x-auto rounded-xl border border-slate-200 dark:border-slate-800 min-h-[300px]",children:[g&&t.jsx("div",{className:"absolute inset-0 bg-white/70 dark:bg-slate-900/80 backdrop-blur-sm flex items-center justify-center z-20",children:t.jsxs("div",{className:"text-center",children:[t.jsx(B,{style:{width:"50px",height:"50px"},strokeWidth:"3",className:"text-sky-500"}),t.jsx("p",{className:"mt-3 text-slate-600 dark:text-slate-300 font-semibold animate-pulse",children:"Cargando..."})]})}),t.jsx(I,{value:b,sortField:r.sort_by,sortOrder:r.sort_direction==="asc"?1:-1,onSort:R,pt:{table:{className:"w-full min-w-[700px]"},thead:{className:"border-b border-slate-200 dark:border-slate-700"},tbody:{className:"divide-y divide-slate-100 dark:divide-slate-800"},bodyRow:{className:"transition-colors duration-200 hover:!bg-sky-50 dark:hover:!bg-sky-900/20"}},children:N.map(s=>t.jsx($,{field:s.key,header:s.title,sortable:_.includes(s.key),bodyClassName:"!p-4 !align-middle text-sm text-slate-700 dark:text-slate-200",pt:{headerCell:{className:"!px-4 !py-3 !text-left !text-xs !font-semibold !uppercase tracking-wider text-slate-500 dark:text-slate-400"}},body:l=>d[s.key]?d[s.key](l):l[s.key]},s.key))}),b.length===0&&!g&&t.jsxs("div",{className:"text-center py-16 text-slate-500 dark:text-slate-400",children:[t.jsx("i",{className:"pi pi-database text-6xl text-slate-300 dark:text-slate-600"}),t.jsx("h3",{className:"mt-4 font-bold text-lg",children:"No hay nada por aquí"}),t.jsx("p",{className:"text-sm",children:"Prueba con otros filtros o ajusta la búsqueda."})]})]}),(e==null?void 0:e.total)>0&&t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 pt-2",children:[t.jsxs("span",{className:"text-sm text-slate-600 dark:text-slate-400 font-medium",children:["Mostrando ",e.from," a ",e.to," de ",e.total," registros"]}),t.jsx(q,{rows:e.per_page,totalRecords:e.total,first:L,onPageChange:O,template:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink",pt:{root:{className:"flex items-center gap-1"},pageButton:({context:s})=>({className:`w-9 h-9 rounded-lg flex items-center justify-center transition-all duration-200 ${s.active?"bg-sky-500 text-white shadow-md hover:bg-sky-600":"text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800"}`})}})]}),t.jsx("style",{children:`
                .slide-fade-enter {
                    transform: translateY(-10px);
                    opacity: 0;
                }
                .slide-fade-enter-active {
                    transform: translateY(0);
                    opacity: 1;
                    transition: all 0.3s ease-out;
                }
                .slide-fade-exit {
                    transform: translateY(0);
                    opacity: 1;
                }
                .slide-fade-exit-active {
                    transform: translateY(-10px);
                    opacity: 0;
                    transition: all 0.3s cubic-bezier(1, 0.5, 0.8, 1);
                }
            `})]})};export{W as E};
